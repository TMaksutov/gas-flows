<!-- simulator.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
  <!-- Google tag (gtag.js) with consent -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MYJRPRS3TW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    
    // Set default consent state
    gtag('consent', 'default', {
      'analytics_storage': 'denied'
    });
    
    gtag('js', new Date());
    gtag('config', 'G-MYJRPRS3TW');
  </script>
  <meta charset="utf-8">
  <title>–ì–∞–∑–æ–≤—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä –ø–æ—Ç–æ–∫–æ–≤</title>
  <link rel="canonical" href="https://gas-flows.com/simulator.html">
  <meta name="description" content="–°–∏–º—É–ª—è—Ü–∏—è –ø–æ—Ç–æ–∫–æ–≤ –≥–∞–∑–∞. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–æ–≤ –ø—Ä–∏—Ä–æ–¥–Ω–æ–≥–æ –≥–∞–∑–∞ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ä–∞—Å—á–µ—Ç–∞ –ø–æ—Ç–æ–∫–∞. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–∞–∑–∞, —Å—Ö–µ–º—ã –ø–æ—Ç–æ–∫–æ–≤ –≥–∞–∑–∞ –∏ —Å–µ—Ç–∏ —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.">
  <meta name="keywords" content="
    —Å–∏–º—É–ª—è—Ü–∏—è –≥–∞–∑–æ–ø—Ä–æ–≤–æ–¥–∞, —Ä–∞—Å—á–µ—Ç —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–∞, –≥—Ä–∞—Ñ —Å–µ—Ç–∏ —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–æ–≤,
    –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ç–æ–∫–∞ –≥–∞–∑–∞, —Å—Ö–µ–º–∞ –ø–æ—Ç–æ–∫–∞ –≥–∞–∑–∞,
    —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–∞–Ω–∞, —Å–∏–º—É–ª—è—Ü–∏—è Cytoscape.js, —Å–∏–º—É–ª—è—Ü–∏—è –≥–∞–∑–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏,
	–æ–Ω–ª–∞–π–Ω —Å–∏–º—É–ª—è—Ü–∏—è –≥–∞–∑–∞, –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –¥–∞–≤–ª–µ–Ω–∏—è –≥–∞–∑–∞, –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –æ–Ω–ª–∞–π–Ω —Å–∏–º—É–ª—è—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –≥–∞–∑–∞">
<link rel="apple-touch-icon" sizes="57x57" href="../icons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../icons/apple-icon-60x60.png">
<link rel="icon" type="image/png" sizes="16x16" href="../icons/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="36x36" href="../icons/android-icon-36x36.png">
<link rel="icon" type="image/png" sizes="48x48" href="../icons/android-icon-48x48.png">
  <link rel="manifest" href="../manifest.json">
  <link rel="stylesheet" href="../common.css">
  

  <!-- Cytoscape -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.22.0/cytoscape.min.js"></script>
</head>
<body>
  <div class="lang-switcher"><select onchange="window.location.href=this.value"><option value="../index.html">EN</option><option value="../de/index.html">DE</option><option value="index.html" selected>RU</option></select></div>
  <nav>
    <ul>
      <li><a href="index.html">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞—Å—Ö–æ–¥–∞</a></li>
      <li><a href="pressures.html">–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –µ–¥–∏–Ω–∏—Ü</a></li>
      <li><a href="aga8.html">AGA8 Z-–§–∞–∫—Ç–æ—Ä</a></li>
      <li><a href="AGA8Flow.html">AGA8 –†–∞—Å—Ö–æ–¥</a></li>
      <li><a href="simulator.html" class="active">–ì–∞–∑–æ–≤—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä</a></li>
      <li><a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
    </ul>
  </nav>
  <!-- Controls area (800px wide, centered) -->
  <div id="controls">
    <button id="buildBtn" class="controlButton" title="–í–æ–π—Ç–∏ –≤ —Ä–µ–∂–∏–º —Å–±–æ—Ä–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ç–∏">üî® –°–±–æ—Ä–∫–∞</button>
    <button id="clearBtn" class="controlButton" title="–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —É–∑–ª—ã –∏ —Ç—Ä—É–±—ã –∏–∑ —Å–µ—Ç–∏">‚ùå</button>
    <button id="recoverButton" class="controlButton" title="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Å–µ—Ç—å">üîÑ </button>
    <button id="RandomBtn" class="controlButton" title="–°–æ–∑–¥–∞—Ç—å —Å–ª—É—á–∞–π–Ω—É—é —Å–µ—Ç—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è">üé≤ </button>

    <button class="controlButton"></button>

    <button id="simulateBtn" class="controlButton" title="–í–æ–π—Ç–∏ –≤ —Ä–µ–∂–∏–º —Å–∏–º—É–ª—è—Ü–∏–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Ç–æ–∫–∞ –≥–∞–∑–∞">‚ö° –ó–∞–ø—É—Å–∫</button>

    <button id="pauseBtn" class="controlButton" title="–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é">‚è∏Ô∏è</button>
    <button id="playBtn" class="controlButton" title="–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (—Å–µ–∫—É–Ω–¥—ã)">‚ñ∂Ô∏è</button>
    <button id="playMinBtn" class="controlButton" title="–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é —Å —É—Å–∫–æ—Ä–µ–Ω–∏–µ–º (–º–∏–Ω—É—Ç—ã)">‚è©</button>
    <button id="playHourBtn" class="controlButton" title="–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ (—á–∞—Å—ã)">‚è≠Ô∏è</button>
    <button id="resetButton" class="controlButton" title="–°–±—Ä–æ—Å–∏—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é –≤ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ">‚Ü∫ </button>
    <button id="csvButton" class="controlButton" title="–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–∏–º—É–ª—è—Ü–∏–∏ –≤ CSV —Ñ–∞–π–ª">üìà</button>

    <button class="controlButton"></button>

    <button id="exportButton" class="controlButton" title="–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é —Å–µ—Ç—å –≤ —Ñ–∞–π–ª">üíæ </button>
    <button id="importButton" class="controlButton" title="–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç—å –∏–∑ —Ñ–∞–π–ª–∞">üìÅ </button>
    <button id="helpButton" class="controlButton" title="–û—Ç–∫—Ä—ã—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å–ø—Ä–∞–≤–∫–∏">‚ùì </button>
  </div>


  <script>
    // globals for UI-mode
    let uiMode   = 'build';    // 'build' or 'simulate'
    let simState = 'pause';    // 'pause', 'play_sec', 'play_min', 'play_hour'
  
    function updateControlButtons() {
      const btns = [
        'buildBtn','simulateBtn','clearBtn','RandomBtn',
        'playBtn','playMinBtn','playHourBtn',
        'pauseBtn','resetButton','csvButton','exportButton','importButton','recoverButton'
      ].map(id => document.getElementById(id));
      btns.forEach(b => b.classList.remove('active','deactivated'));
  
      if (uiMode === 'build') {
        document.getElementById('buildBtn').classList.add('active');
        document.getElementById('clearBtn').classList.remove('deactivated');
        document.getElementById('RandomBtn').classList.remove('deactivated');
        document.getElementById('recoverButton').classList.remove('deactivated');
        ['playBtn','playMinBtn','playHourBtn','pauseBtn','resetButton']
          .forEach(id => document.getElementById(id).classList.add('deactivated'));
        document.getElementById('simulateBtn').classList.remove('deactivated');
        
        // Export/Import buttons always available
        ['exportButton','importButton'].forEach(id => 
          document.getElementById(id).classList.remove('deactivated'));
        
        // CSV button state based on data availability
        if (window.updateCSVButtonState) {
          window.updateCSVButtonState();
        }
      } else {
        document.getElementById('simulateBtn').classList.add('active');
        document.getElementById('clearBtn').classList.add('deactivated');
        document.getElementById('RandomBtn').classList.add('deactivated');
        document.getElementById('recoverButton').classList.add('deactivated');
        ['playBtn','playMinBtn','playHourBtn','pauseBtn','resetButton','buildBtn']
          .forEach(id => document.getElementById(id).classList.remove('deactivated'));
        
        // Export/Import buttons always available
        ['exportButton','importButton'].forEach(id => 
          document.getElementById(id).classList.remove('deactivated'));
        
        // CSV button state based on data availability
        if (window.updateCSVButtonState) {
          window.updateCSVButtonState();
        }
        
        if (simState === 'pause')      document.getElementById('pauseBtn').classList.add('active');
        if (simState === 'play_sec')   document.getElementById('playBtn').classList.add('active');
        if (simState === 'play_min')   document.getElementById('playMinBtn').classList.add('active');
        if (simState === 'play_hour')  document.getElementById('playHourBtn').classList.add('active');
      }
    }
  
    function setUIMode(m) {
      uiMode = m;
      // persist UI mode
      localStorage.setItem('uiMode', m);
      if (m === 'build') {
        setSimState('pause');
      }
      updateControlButtons();
    }
  
    function setSimState(s) {
      simState = s;
      // persist simulation state
      localStorage.setItem('simState', s);
      updateControlButtons();
    }
  
    // wire up your controls
    document.getElementById('buildBtn').addEventListener('click', () => {
      setUIMode('build');
      setSimulationMode('stop', cy, updateInfo);
      // Don't reset simulation data - preserve pressures and injections
    });
    document.getElementById('simulateBtn').addEventListener('click', () => {
      setUIMode('simulate');
      setSimState('pause');
      setSimulationMode('stop', cy, updateInfo);
    });
    document.getElementById('clearBtn').addEventListener('click', () => {
      if (uiMode !== 'build') return;
      clearGraph();
      setUIMode('build');
      setSimulationMode('stop', cy, updateInfo);
    });
    document.getElementById('RandomBtn').addEventListener('click', () => {
      if (uiMode !== 'build') return;
      if (window.generateRandomNetwork) {
        generateRandomNetwork();
      } else {
        console.error('Random network generation function not available.');
      }
      setUIMode('build');
      setSimulationMode('stop', cy, updateInfo);
    });
    document.getElementById('playBtn').addEventListener('click', () => {
      if (uiMode !== 'simulate') return;
      setSimulationMode('sec', cy, updateInfo);
      setSimState('play_sec');
    });
    document.getElementById('playMinBtn').addEventListener('click', () => {
      if (uiMode !== 'simulate') return;
      setSimulationMode('min', cy, updateInfo);
      setSimState('play_min');
    });
    document.getElementById('playHourBtn').addEventListener('click', () => {
      if (uiMode !== 'simulate') return;
      setSimulationMode('hour', cy, updateInfo);
      setSimState('play_hour');
    });
    document.getElementById('pauseBtn').addEventListener('click', () => {
      setSimulationMode('stop', cy, updateInfo);
      setSimState('pause');
    });
    document.getElementById('resetButton').addEventListener('click', () => {
      if (uiMode !== 'simulate') return;
      resetSimulation();
      setSimState('pause');
    });
    document.getElementById('csvButton').addEventListener('click', () => {
      const csvButton = document.getElementById('csvButton');
      if (csvButton.disabled || csvButton.classList.contains('deactivated')) {
        return; // Don't do anything if button is disabled
      }
      
      if (window.generateCSV) {
        window.generateCSV();
      } else {
        console.error('CSV generation function not available.');
      }
    });
  
    // on page load, restore last UI mode but always stay paused
    window.addEventListener('DOMContentLoaded', () => {
      simulationMode = 'stop';
      // restore build vs. simulate
      const savedMode = localStorage.getItem('uiMode');
      if (savedMode === 'simulate') {
        setUIMode('simulate');
      } else {
        setUIMode('build');
      }
      // force pause
      setSimState('pause');
      // ensure no simulation runs until user clicks Play
      setSimulationMode('stop', cy, updateInfo);
      
      // Initialize CSV button state
      if (window.updateCSVButtonState) {
        window.updateCSVButtonState();
      }
    });
  </script>
  


  <!-- Cytoscape container: full browser width -->
  <div id="cy"></div>
	  
  <!-- Info area - Edges Data (Collapsible) -->
  <div class="collapsible-container">
    <div class="collapsible-header">
      <div id="simulation-summary" style="font-size: 0.9em; color: #666; margin-top: 5px;">
        –û–±—â–∏–π –æ–±—ä–µ–º –≥–∞–∑–∞: 0.00 √ó 10‚Å∂ –º¬≥ | –í—Ö–æ–¥—ã: 0 –º¬≥/—á, –í—ã—Ö–æ–¥—ã: 0 –º¬≥/—á | –°–∏–º—É–ª—è—Ü–∏—è: 0 —á 0 –º 0 —Å
      </div>
      <span class="collapsible-toggle">‚ñº</span>
    </div>
    <div class="collapsible-content">
      <div id="info-edges">
        <!-- Edges table will be injected here -->
      </div>
    </div>
  </div>

  <!-- Info area - Nodes Data (Collapsible) -->
  <div class="collapsible-container">
    <div class="collapsible-header">
      <h3> –î–∞–Ω–Ω—ã–µ —É–∑–ª–æ–≤ –∏ —Ç–æ—á–∫–∏ –∏–Ω—ä–µ–∫—Ü–∏–∏ –≥–∞–∑–∞</h3>
      <span class="collapsible-toggle">‚ñº</span>
    </div>
    <div class="collapsible-content">
      <div id="info-nodes">
        <!-- Nodes table will be injected here -->
      </div>
    </div>
  </div>
	
<!-- Scenario script UI (collapsible) -->
<div class="collapsible-container">
  <div class="collapsible-header">
    <h3> –°—Ü–µ–Ω–∞—Ä–∏–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</h3>
    <span class="collapsible-toggle">‚ñº</span>
  </div>
  <div class="collapsible-content">
    <div class="script-content">
      <textarea id="scriptInput" rows="8"
        placeholder="–ß–ß:–ú–ú:–°–° –∏–ª–∏ —É—Å–ª–æ–≤–∏–µ , –¥–µ–π—Å—Ç–≤–∏–µ
00:01:00, n0.injection = 100  # –∏–Ω—ä–µ–∫—Ü–∏—è –≤ –º¬≥/—á–∞—Å
n0.pressure > 0.1, n0.injection = 200  # –∏–Ω—ä–µ–∫—Ü–∏—è –≤ –º¬≥/—á–∞—Å
n1.pressure > 10, n1_n3.disable = true
0:00:00, n0.pressure = 22
05:00:01, n0.pressureSet = true
99:00:45, n2.pressure = 7.5
105:00:46, n2.pressureSet = true
n3.flow < -5, n3_n0.reverse = true  # –ø–æ—Ç–æ–∫ –≤ –º¬≥/—á–∞—Å
n0_n2.flow > 12, n0_n2.disable = true  # –ø–æ—Ç–æ–∫ –≤ –º¬≥/—á–∞—Å"></textarea>

      <pre id="scriptStatus"></pre>
    </div>
  </div>
</div>

<script src="js/script_engine.js"></script>


  <footer  class="container" style="margin-top: 5px; font-size: 0.9em;">
    <h2>–ö–∞–∫ —Å–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫–∏ –≥–∞–∑–∞ –≤ —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–∞—Ö?</h2>
    <p>–í —Ä–µ–∂–∏–º–µ —Å–±–æ—Ä–∫–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é —Å–µ—Ç—å, –¥–æ–±–∞–≤—å—Ç–µ —É–∑–ª—ã –∏ —Ç—Ä—É–±—ã –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–Ω—ä–µ–∫—Ü–∏–∏ –∏–ª–∏ –æ—Ç–±–æ—Ä—ã –≤ —É–∑–ª–∞—Ö –∏–ª–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –¥–∞–≤–ª–µ–Ω–∏–µ –≤ –ª—é–±–æ–π —Ç–æ—á–∫–µ. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Å–ª—É—á–∞–π–Ω—É—é —Å–µ—Ç—å. –í —Ä–µ–∂–∏–º–µ –∑–∞–ø—É—Å–∫–∞ –Ω–∞—á–Ω–∏—Ç–µ —Å–∏–º—É–ª—è—Ü–∏—é, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ —Ç—Ä–µ—Ö —Å–∫–æ—Ä–æ—Å—Ç–µ–π, –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–ª–∏ —Å–±—Ä–æ—Å—å—Ç–µ. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –≤–∏–¥–µ CSV-–ª–æ–≥–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ –ø–æ —É—Å–ª–æ–≤–∏—è–º. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤—Ö–æ–¥—ã –∏ –≤—ã—Ö–æ–¥—ã –≤ —Ä–∞–∑–¥–µ–ª–µ –î–∞–Ω–Ω—ã–µ —É–∑–ª–æ–≤ –∏ —Ç–æ—á–∫–∏ –∏–Ω—ä–µ–∫—Ü–∏–∏ –≥–∞–∑–∞. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–≤–æ—é —Å–µ—Ç—å.</p>
    <p><strong>–û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:</strong> –≠—Ç–æ—Ç —Å–∏–º—É–ª—è—Ç–æ—Ä –ø–æ—Ç–æ–∫–æ–≤ –≥–∞–∑–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π. –†–∞—Å—á–µ—Ç—ã, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —ç—Ç–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º, –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –æ–±—â–∏—Ö –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è—Ö –∏ –º–æ–≥—É—Ç –Ω–µ –æ—Ç—Ä–∞–∂–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —É—Å–∏–ª–∏—è –ø–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—é —Ç–æ—á–Ω–æ—Å—Ç–∏, –º—ã –Ω–µ –¥–∞–µ–º –Ω–∏–∫–∞–∫–∏—Ö –≥–∞—Ä–∞–Ω—Ç–∏–π –∏ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –æ—à–∏–±–∫–∏ –∏–ª–∏ —Ä–µ—à–µ–Ω–∏—è, –ø—Ä–∏–Ω—è—Ç—ã–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –í—Å–µ–≥–¥–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏–Ω–∂–µ–Ω–µ—Ä–æ–º –∏–ª–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º —ç–∫—Å–ø–µ—Ä—Ç–æ–º –ø–µ—Ä–µ–¥ –ø—Ä–∏–Ω—è—Ç–∏–µ–º —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.</p>
  </footer>
  
  <script src="../js/csv_logger.js"></script>
  <script src="../js/random_generator.js"></script>
  <script src="../js/graph_io.js"></script>
  <script src="../js/formulas.js"></script>
  <script src="../js/simulation.js"></script>
  <script src="../js/ui.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Cookie Consent -->
  <script src="../js/cookies.js"></script>

<!-- Help Modal (iframe-based, loads help.html) -->
<div id="helpModalContainer" class="modal" style="display:none;">
  <div class="modal-content" style="padding:0; max-width:700px; width:90vw; max-height:500px; height:80vh;">
    <iframe
      id="helpIframe"
      src="help.html"
      style="width:100%; height:100%; border:none;">
    </iframe>
  </div>
</div>

<script>
  const helpButton = document.getElementById('helpButton');
  const helpModalContainer = document.getElementById('helpModalContainer');

  // Close on message from iframe
  window.addEventListener('message', event => {
    if (event.data?.type === 'closeHelpModal') {
      helpModalContainer.style.display = 'none';
    }
  });

  helpButton.addEventListener('click', () => {
    // Only pause simulation if we're already in simulate mode
    if (uiMode === 'simulate') {
      if (typeof setSimulationMode === 'function') {
        setSimulationMode('stop', cy, updateInfo);
      }
      setSimState('pause');
      // ensure the simulate button stays active
      setUIMode('simulate');
    }
    // Show the help overlay regardless of mode
    helpModalContainer.style.display = 'block';
  });
</script>
